library(testthat)

test1_obj <- c('4D', '54', '68', '64', '00', '00', '00', '06', '00', '01', '00', '4', '00', '60', '4D', '54', '72', '6B', '00', '00', '00', '14',
  '00', 'FF', '58', '04', '04', '02', '18', '08', '00', 'FF', '51', '03', '07', 'A1', '20', '83', '00', 'FF', '2F', '00', '4D', '54',
  '72', '6B', '00', '00', '0', '87', '00', 'C0', '76', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30',
  '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a',
  '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00',
  '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a',
  '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30',
  '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a',
  '7F', '30', '80', '2a', '00', '00', 'FF', '2F', '00', '4D', '54', '72', '6B', '00', '00', '0', '2a', '00', 'C0', '76', '0', '90',
  '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80',
  '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '00', 'FF', '2F', '00', '4D', '54', '72', '6B', '00', '00', '0',
  '19', '00', 'C0', '76', '81', '40', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00',
  '00', 'FF', '2F', '00')


test2_obj <- c('4D', '54', '68', '64', '00', '00', '00', '06', '00', '01', '00', '4', '00', '60', '4D', '54', '72', '6B', '00', '00', '00',
               '14', '00', 'FF', '58', '04', '04', '02', '18', '08', '00', 'FF', '51', '03', '07', 'A1', '20', '83', '00', 'FF', '2F', '00',
               '4D', '54', '72', '6B', '00', '00', '2', '7', '00', 'C0', '76', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90',
               '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a',
               '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F',
               '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00',
               '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80',
               '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a',
               '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00',
               '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30',
               '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90',
               '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a',
               '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F',
               '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00',
               '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80',
               '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a',
               '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00',
               '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30',
               '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90',
               '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a',
               '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F',
               '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00',
               '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80',
               '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a',
               '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00',
               '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30',
               '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', '90', '2a', '7F', '30', '80', '2a', '00', '00', 'FF',
               '2F', '00', '4D', '54', '72', '6B', '00', '00', '0', '96', '00', 'C0', '76', '0', '90', '24', '7F', '30', '80', '24', '00',
               '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90',
               '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30',
               '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00',
               '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90',
               '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30',
               '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00',
               '81', '10', '90', '24', '7F', '30', '80', '24', '00', '00', 'FF', '2F', '00', '4D', '54', '72', '6B', '00', '00', '0', '4f',
               '00', 'C0', '76', '81', '40', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00',
               '82', '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90',
               '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '30',
               '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00', '00', 'FF', '2F', '00')

test3_obj <- c('4D', '54', '68', '64', '00', '00', '00', '06', '00', '01', '00', '4', '00', '60', '4D', '54', '72', '6B', '00', '00', '00',
               '14', '00', 'FF', '58', '04', '04', '02', '18', '08', '00', 'FF', '51', '03', '07', 'A1', '20', '83', '00', 'FF', '2F', '00',
               '4D', '54', '72', '6B', '00', '00', '4', 'f7', '00', 'C0', '76', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90',
               '2c', '7F', '30', '80', '2c', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a',
               '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F',
               '18', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0',
               '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '30', '90', '2c', '7F', '30', '80',
               '2c', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a',
               '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00',
               '0', '90', '33', '7F', '30', '80', '33', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '18',
               '80', '2a', '00', '0', '90', '33', '7F', '30', '80', '33', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90',
               '2a', '7F', '30', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2a', '7F', '30', '80', '2a',
               '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F',
               '10', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0',
               '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '33', '7F', '30', '80', '33', '00', '30', '90', '2a', '7F', '30', '80',
               '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '30', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a',
               '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00',
               '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '30', '90', '2a', '7F', '18',
               '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '30', '90',
               '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a',
               '00', '30', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F',
               '18', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0',
               '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2a', '7F', '10', '80',
               '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a',
               '7F', '30', '80', '2a', '00', '30', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '33', '7F', '30', '80', '33', '00',
               '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80',
               '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F',
               '10', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90',
               '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00',
               '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2a', '7F', '30', '80',
               '2a', '00', '30', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F',
               '10', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90',
               '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '33', '7F', '30', '80', '33', '00',
               '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '18',
               '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90',
               '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a',
               '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2c', '7F',
               '30', '80', '2c', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90',
               '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00',
               '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '33', '7F', '30', '80',
               '33', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a',
               '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00',
               '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '30',
               '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90',
               '2a', '7F', '30', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2a', '7F', '30', '80', '2a',
               '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F',
               '30', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0',
               '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80',
               '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a',
               '7F', '18', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00',
               '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '10',
               '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90',
               '2a', '7F', '30', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2a', '7F', '30', '80', '2a',
               '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F',
               '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0',
               '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80',
               '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '60', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2c',
               '7F', '30', '80', '2c', '00', '30', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00',
               '30', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10', '80', '2a', '00', '0', '90', '2a', '7F', '10',
               '80', '2a', '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2a', '7F', '18', '80', '2a', '00', '0', '90',
               '2a', '7F', '18', '80', '2a', '00', '0', '90', '2c', '7F', '30', '80', '2c', '00', '0', '90', '2c', '7F', '30', '80', '2c',
               '00', '0', '90', '2a', '7F', '30', '80', '2a', '00', '30', '90', '2a', '7F', '30', '80', '2a', '00', '0', '90', '2c', '7F',
               '30', '80', '2c', '00', '00', 'FF', '2F', '00', '4D', '54', '72', '6B', '00', '00', '1', '3e', '00', 'C0', '76', '0', '90',
               '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30',
               '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '18', '80', '24', '00',
               '0', '90', '24', '7F', '18', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24',
               '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80',
               '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81',
               '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90',
               '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F',
               '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24',
               '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10',
               '90', '24', '7F', '18', '80', '24', '00', '0', '90', '24', '7F', '18', '80', '24', '00', '81', '10', '90', '24', '7F', '30',
               '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00',
               '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90',
               '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '18',
               '80', '24', '00', '0', '90', '24', '7F', '18', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '81',
               '10', '90', '24', '7F', '30', '80', '24', '00', '81', '10', '90', '24', '7F', '30', '80', '24', '00', '00', 'FF', '2F', '00',
               '4D', '54', '72', '6B', '00', '00', '0', 'af', '00', 'C0', '76', '81', '40', '90', '26', '7F', '30', '80', '26', '00', '82',
               '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26',
               '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80',
               '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '04', '90', '26', '7F', '2c',
               '80', '26', '00', '00', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F',
               '30', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '04', '90', '26',
               '7F', '2c', '80', '26', '00', '00', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90',
               '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '30', '80', '26', '00', '82', '50', '90', '26', '7F', '04',
               '90', '26', '7F', '2c', '80', '26', '00', '00', '80', '26', '00', '00', 'FF', '2F', '00')

test_that("The drum_machine function can create a basic 4-4 beat", {
  expect_equal(drum_machine(hh = 1:16, kick = seq(1, 16, by = 4), snare = c(5, 13)) %>% create_midi(),test1_obj)
})

test_that("The rep parameter of drum_machine works", {
  expect_equal(drum_machine(hh = 1:16, kick = seq(1, 16, by = 4), snare = c(5, 13), rep = 4) %>% create_midi(),test2_obj)
})

set.seed(123)
test_that("random_modifier with multiple modifications works", {
  expect_equal(drum_machine(hh = 1:16, kick = seq(1, 16, by = 4), snare = c(5, 13), rep = 8) %>%
                 random_modify(., modifier = "double", position = template(2,4,6, every = 8), prob = .7, track_apply = 1) %>%
                 random_modify(., modifier = "roll", position = template(8, every = 8), prob = .7, track_apply = 1) %>%
                 random_modify(., modifier = "double", position = template(1, every = 16), prob = .7, track_apply = 2) %>%
                 random_modify(., modifier = "flam", position = template(29, every = 32), prob = .7, track_apply = 3) %>%
                 random_muter(., prob = .1, track_apply = 1) %>%
                 drum_shifter(., shift = 'D#2', prob = .1, track_apply = 1) %>%
                 drum_shifter(., shift = 'G#1', prob = .2, track_apply = 1) %>% create_midi(),test3_obj)
})



